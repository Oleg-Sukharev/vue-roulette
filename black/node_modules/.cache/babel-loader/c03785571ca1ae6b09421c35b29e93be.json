{"remainingRequest":"/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/babel-loader/lib/index.js!/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/oleg/Desktop/magic/local/vue-roulette/black/src/components/RouletteView.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/oleg/Desktop/magic/local/vue-roulette/black/src/components/RouletteView.vue","mtime":1596738695977},{"path":"/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/oleg/Desktop/magic/local/vue-roulette/black/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgcmFuZG9tSW5kZXggfSBmcm9tICcuLi9oZWxwZXJzJzsKaW1wb3J0IEFjdGlvbkJ1dHRvbiBmcm9tICcuL0FjdGlvbkJ1dHRvbic7CmltcG9ydCBQb3B1cCBmcm9tICcuL3JvdWxldHRlL1BvcHVwJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdSb3VsZXR0ZVZpZXcnLAogIGNvbXBvbmVudHM6IHsKICAgIEFjdGlvbkJ1dHRvbjogQWN0aW9uQnV0dG9uLAogICAgUG9wdXA6IFBvcHVwCiAgfSwKICBwcm9wczogewogICAgbWF4Um90YXRpb25zOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMwogICAgfSwKICAgIHByaXplczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBhbmltYXRpb25EdXJhdGlvbjogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDMKICAgIH0sCiAgICBkYXRhOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50Um90YXRpb246IDAsCiAgICAgIGN1cnJlbnRQcml6ZUluZGV4OiAtMSwKICAgICAgYW5pbWF0aW9uUnVuOiBmYWxzZSwKICAgICAgcG9wdXBTaG93OiBmYWxzZSwKICAgICAgYWN0aW9uVGV4dDogdGhpcy5kYXRhLnNwaW4KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgcm90YXRpb25Nb3JlSW5kZXhlczogZnVuY3Rpb24gcm90YXRpb25Nb3JlSW5kZXhlcygpIHsKICAgICAgcmV0dXJuIHRoaXMucHJpemVzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwcml6ZSwgaW5kZXgpIHsKICAgICAgICBpZiAocHJpemUuaXNSb3RhdGlvbk1vcmUpIHsKICAgICAgICAgIGFjYy5wdXNoKGluZGV4KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBhY2M7CiAgICAgIH0sIFtdKTsKICAgIH0sCiAgICB0YXJnZXRQcml6ZUluZGV4OiBmdW5jdGlvbiB0YXJnZXRQcml6ZUluZGV4KCkgewogICAgICByZXR1cm4gdGhpcy5wcml6ZXMuZmluZEluZGV4KGZ1bmN0aW9uIChwcml6ZSkgewogICAgICAgIHJldHVybiBwcml6ZS5pc1RhcmdldFByaXplOwogICAgICB9KTsKICAgIH0sCiAgICByb3VsZXR0ZUNsYXNzZXM6IGZ1bmN0aW9uIHJvdWxldHRlQ2xhc3NlcygpIHsKICAgICAgcmV0dXJuIFsncm91bGV0dGUnLCB0aGlzLmN1cnJlbnRQcml6ZUluZGV4ICE9PSAtMSA/ICJudW1iZXItIi5jb25jYXQodGhpcy5jdXJyZW50UHJpemVJbmRleCArIDEpIDogJyddOwogICAgfSwKICAgIHJvdWxldHRlU3R5bGVzOiBmdW5jdGlvbiByb3VsZXR0ZVN0eWxlcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBhbmltYXRpb25EdXJhdGlvbjogIiIuY29uY2F0KHRoaXMuYW5pbWF0aW9uRHVyYXRpb24sICJzIikKICAgICAgfTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJvdGF0aW9uUm91bGV0dGU6IGZ1bmN0aW9uIHJvdGF0aW9uUm91bGV0dGUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5hbmltYXRpb25SdW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uKys7CiAgICAgIHRoaXMuYW5pbWF0aW9uUnVuID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmN1cnJlbnRSb3RhdGlvbiA8IHRoaXMubWF4Um90YXRpb25zKSB7CiAgICAgICAgdmFyIHJvdGF0aW9uTW9yZUluZGV4ZXMgPSB0aGlzLnJvdGF0aW9uTW9yZUluZGV4ZXMuc2xpY2UoMCk7CiAgICAgICAgdmFyIGZyZWVGaWVsZHMgPSByb3RhdGlvbk1vcmVJbmRleGVzLmZpbHRlcihmdW5jdGlvbiAobnVtKSB7CiAgICAgICAgICByZXR1cm4gbnVtICE9PSBfdGhpcy5jdXJyZW50UHJpemVJbmRleDsKICAgICAgICB9KTsKICAgICAgICB0aGlzLmN1cnJlbnRQcml6ZUluZGV4ID0gZnJlZUZpZWxkc1tyYW5kb21JbmRleChmcmVlRmllbGRzLmxlbmd0aCldOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY3VycmVudFByaXplSW5kZXggPSB0aGlzLnRhcmdldFByaXplSW5kZXg7CiAgICAgIH0KCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzLmFuaW1hdGlvblJ1biA9IGZhbHNlOwogICAgICAgIF90aGlzLmFjdGlvblRleHQgPSBfdGhpcy5zZXRBY3Rpb25UZXh0KCk7CgogICAgICAgIGlmIChfdGhpcy5jdXJyZW50Um90YXRpb24gPj0gX3RoaXMubWF4Um90YXRpb25zKSB7CiAgICAgICAgICBfdGhpcy5wb3B1cFNob3cgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwgdGhpcy5hbmltYXRpb25EdXJhdGlvbiAqIDEwMDApOwogICAgfSwKICAgIHNldEFjdGlvblRleHQ6IGZ1bmN0aW9uIHNldEFjdGlvblRleHQoKSB7CiAgICAgIHZhciBjdXJyZW50UHJpemUgPSB0aGlzLmN1cnJlbnRQcml6ZUluZGV4ICE9PSBudWxsICYmIHRoaXMucHJpemVzW3RoaXMuY3VycmVudFByaXplSW5kZXhdOwogICAgICB2YXIgdGV4dCA9IHRoaXMuZGF0YS5zcGluOwoKICAgICAgaWYgKGN1cnJlbnRQcml6ZSAmJiBjdXJyZW50UHJpemUuaXNSb3RhdGlvbk1vcmUpIHsKICAgICAgICB0ZXh0ID0gdGhpcy5kYXRhLnNwaW4gKyAiICIgKyB0aGlzLmRhdGEubW9yZSArICIgIiArIHRoaXMuZGF0YS50aW1lOwogICAgICB9CgogICAgICByZXR1cm4gdGV4dDsKICAgIH0sCiAgICBuZXh0SGFuZGxlcjogZnVuY3Rpb24gbmV4dEhhbmRsZXIoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ25leHQnKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["RouletteView.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"roulette-screen\">\n    <div class=\"roulette__text\">\n      <p class=\"roulette__motivation\">{{data.spinAndWin}}</p>\n      <p class=\"roulette__reward\">{{data.awesomePrizes}}</p>\n    </div>\n    <div class=\"roulette__frame\">\n      <ul :class=\"rouletteClasses\" :style=\"rouletteStyles\">\n        <li v-for=\"(prize, index) of prizes\" :key=\"index + 1\" class=\"roulette-item\">\n          <div v-if=\"prize.isRotationMore\" class=\"roulette__prize-text-position\">\n            <span class=\"roulette__prize-text\">\n             {{data.spin}} {{data.more}}\n            </span>\n          </div>\n          <img v-else class=\"roulette__prize-image\" :src=\"prize.prizeImage\" alt=\"\">\n        </li>\n      </ul>\n    </div>\n    <div class=\"roulette__controls\">\n      <action-button theme-type=\"light\" @click=\"rotationRoulette\">{{ actionText }}</action-button>\n    </div>\n\n    <portal v-if=\"popupShow\" to=\"popup\">\n      <popup :prize=\"prizes[currentPrizeIndex]\" :data=\"data\" @next=\"nextHandler\"/>\n    </portal>\n  </div>\n</template>\n\n<script>\nimport { randomIndex } from '../helpers';\nimport ActionButton from './ActionButton';\nimport Popup from './roulette/Popup';\n\nexport default {\n  name: 'RouletteView',\n  components: {\n    ActionButton,\n    Popup,\n  },\n  props: {\n    maxRotations: {\n      type: Number,\n      default: 3,\n    },\n    prizes: {\n      type: Array,\n      required: true,\n    },\n    animationDuration: {\n      type: Number,\n      default: 3,\n    },\n    data:{\n      type: Object,\n      required: true,\n    }\n  },\n  data() {\n    return {\n      currentRotation: 0,\n      currentPrizeIndex: -1,\n      animationRun: false,\n      popupShow: false,\n      actionText: this.data.spin,\n    };\n  },\n  computed: {\n    rotationMoreIndexes() {\n      return this.prizes.reduce((acc, prize, index) => {\n        if (prize.isRotationMore) {\n          acc.push(index);\n        }\n        return acc;\n      }, []);\n    },\n    targetPrizeIndex() {\n      return this.prizes.findIndex(prize => prize.isTargetPrize);\n    },\n    rouletteClasses() {\n      return ['roulette', this.currentPrizeIndex !== -1 ? `number-${this.currentPrizeIndex + 1}` : ''];\n    },\n    rouletteStyles() {\n      return {\n        animationDuration: `${this.animationDuration}s`,\n      };\n    },\n  },\n  methods: {\n    rotationRoulette() {\n      if (this.animationRun) {\n        return;\n      }\n      this.currentRotation++;\n      this.animationRun = true;\n      if (this.currentRotation < this.maxRotations) {\n        const rotationMoreIndexes = this.rotationMoreIndexes.slice(0);\n        const freeFields = rotationMoreIndexes.filter(num => num !== this.currentPrizeIndex);\n        this.currentPrizeIndex = freeFields[randomIndex(freeFields.length)];\n      } else {\n        this.currentPrizeIndex = this.targetPrizeIndex;\n      }\n      setTimeout(() => {\n        this.animationRun = false;\n        this.actionText = this.setActionText();\n        if (this.currentRotation >= this.maxRotations) {\n          this.popupShow = true;\n        }\n      }, this.animationDuration * 1000);\n    },\n    setActionText() {\n      const currentPrize = this.currentPrizeIndex !== null && this.prizes[this.currentPrizeIndex];\n      let text = this.data.spin;\n      if (currentPrize && currentPrize.isRotationMore) {\n        text = this.data.spin + \" \" + this.data.more + \" \" + this.data.time;\n      }\n      return text;\n    },\n    nextHandler() {\n      this.$emit('next');\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n  .roulette-screen {\n\n  }\n\n  .roulette {\n    width: 308px;\n    height: 308px;\n    padding: 0;\n    margin: 0;\n    position: relative;\n    border-radius: 50%;\n    overflow: hidden;\n    counter-reset: num;\n    background:\n      center / contain no-repeat url(\"../../public/img/roulette__table.png\");\n    animation-timing-function: cubic-bezier(0,.4,.4,1.04);\n    animation-fill-mode: forwards;\n    animation-iteration-count: 1;\n\n    @for $i from 1 through 8 {\n      &.number-#{$i} {\n        animation-name: 'number-#{$i}';\n      }\n    }\n  }\n\n  .roulette-item {\n    position: absolute;\n    top: 30px;\n    right: 0;\n    left: 0;\n    display: block;\n    margin: auto;\n    width: 100px;\n    height: 124px;\n    transform-origin: 50px 124px;\n\n    @for $i from 1 through 8 {\n      &:nth-of-type(#{$i}) {\n        transform: rotate(#{$i * 45deg});\n      }\n    }\n  }\n\n  @for $d from 1 through 8 {\n    @keyframes number-#{$d} {\n      from {\n        transform: rotate(0);\n      }\n      to {\n        transform: rotate(#{360 * 7 - 45 * $d}deg);\n      }\n    }\n  }\n\n  .roulette__controls {\n    display: flex;\n    justify-content: center;\n    margin-top: 30px;\n  }\n  .roulette__button {\n    background-color: #0051EF;\n    color: #FFFFFF;\n    font-size: 1rem;\n    text-transform: uppercase;\n    border-radius: 1rem;\n    border: none;\n  }\n  .roulette__frame {\n    position: relative;\n    display: flex;\n    justify-content: center;\n    margin-top: 1rem;\n    margin-bottom: 1rem;\n    background: center / contain no-repeat url(\"../../public/img/roulette-field.png\");\n    overflow: hidden;\n    &:after {\n      content: \"\";\n      display: block;\n      margin: auto;\n      width: 72px;\n      height: 75px;\n      background: center / contain no-repeat url(\"../../public/img/roulette__arrow.png\");\n      position: absolute;\n      top: -16px;\n      right: -2px;\n      left: 0;\n    }\n  }\n  .roulette__prize-image {\n    display: block;\n    max-width: 63%;\n    margin: 0 auto;\n    max-height: 70px;\n  }\n\n  .roulette__prize-text-position {\n    height: 100%;\n    display: flex;\n    justify-content: center;\n  }\n\n  .roulette__prize-text {\n    writing-mode: tb-rl;\n    transform: rotate(180deg);\n    font-size: 0.8rem;\n    font-weight: 600;\n    text-align: end;\n    text-transform: uppercase;\n    color: #FFFFFF;\n  }\n\n  .roulette__motivation {\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n    line-height: 1.1;\n    text-transform: uppercase;\n    color: #96B9FF;\n    text-align: center;\n  }\n  @media (max-width: 599.99px) {\n    .roulette__motivation {\n      font-size: 1rem;\n    }\n  }\n\n  .roulette__reward {\n    margin-top: 0;\n    font-weight: 600;\n    line-height: 1.1;\n    text-transform: uppercase;\n    color: #96B9FF;\n    text-align: center;\n  }\n  @media (max-width: 599.99px) {\n    .roulette__reward {\n      font-size: 1.4rem;\n    }\n  }\n</style>"],"sourceRoot":"src/components"}]}